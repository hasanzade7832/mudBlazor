@using BlazorApp1.Models.TaskManagement
@inject IAdminService AdminService

<link href="css/MyTasks/MyTaskCard.css" rel="stylesheet" />

<MudCard Class="@CardClass" Elevation="2">
    <!-- بج‌ها بالا کارت -->
    <div class="mytask-badges-top">
        <div class="badge-floating badge-floating-left">
            <MudChip T="string"
                     Color="@RemainBadgeColor"
                     Variant="Variant.Filled"
                     Size="Size.Large"
                     Class="badge-chip-top">
                @RemainBadgeText
            </MudChip>
        </div>
        <div class="badge-floating badge-floating-right">
            <MudChip T="string"
                     Color="@StatusBadgeColor"
                     Variant="Variant.Filled"
                     Size="Size.Large"
                     Class="@StatusChipTopClass">
                @StatusBadgeText
                @if (UserTask?.IsCompletedByUser == true && !(UserTask?.IsConfirmedByAdmin ?? false))
                {
                    <span class="dot-pulse"></span>
                }
            </MudChip>
        </div>
    </div>

    <MudCardContent>
        <div class="mytask-header">
            <div class="mytask-header-info">
                <MudText Typo="Typo.h6" Class="mytask-title">
                    <div class="mytask-title-scroll">@TaskTitle</div>
                </MudText>
                @if (!string.IsNullOrWhiteSpace(TaskDescription))
                {
                    <MudText Typo="Typo.body2" Class="mytask-desc">
                        <div class="mytask-desc-scroll">@TaskDescription</div>
                    </MudText>
                }
            </div>
        </div>
        <div class="mytask-actions">
            <MudSlider T="int"
                       Dir="Direction.LeftToRight"
                       Min="0"
                       Max="100"
                       Step="5"
                       Value="@Percent"
                       Disabled="@(!CanEdit)"
                       ValueChanged="@(v => OnPercentChanged(v))"
                       Immediate="true"
                       Color="Color.Primary"
                       Class="mytask-slider" />
            <div class="mytask-percent">@Percent %</div>
            <MudButton Variant="Variant.Filled"
                       Disabled="@(!CanSave)"
                       OnClick="@SaveProgress"
                       Color="Color.Primary"
                       Class="mytask-save-btn">
                ثبت
            </MudButton>
        </div>
    </MudCardContent>
</MudCard>
