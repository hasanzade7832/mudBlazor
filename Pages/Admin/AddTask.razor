@inherits AddTask

<MudPaper Class="pa-4">
    <MudForm @ref="form"
             @bind-IsValid="isValid"
             @bind-Errors="errors">

        <MudText Typo="Typo.h6" Class="mb-4">
            @(IsEditing ? "ویرایش تسک" : "تسک جدید")
        </MudText>

        <MudTextField T="string"
                      Label="عنوان"
                      @bind-Value="_model.Title"
                      Required="true"
                      RequiredError="عنوان اجباری است!" />

        <MudTextField T="string"
                      Label="توضیحات"
                      @bind-Value="_model.Description"
                      TextArea="true"
                      Lines="3" />

        <MudDatePicker T="DateTime?"
                       Label="مهلت انجام"
                       @bind-Date="_deadline"
                       Required="true"
                       RequiredError="تاریخ را انتخاب کنید!"
                       Validation="ValidateDeadline" />

        <MudSelect T="string"
                   Label="کاربر مسئول"
                   Placeholder="-- انتخاب کاربر --"
                   @bind-Value="_selectedUserId"
                   Required="true"
                   RequiredError="کاربر را انتخاب کنید!">
            @foreach (var u in Users)
            {
                <MudSelectItem T="string" Value="@u.Id">@u.UserName</MudSelectItem>
            }
        </MudSelect>

        <MudStack Direction="Row" Spacing="2" Class="mt-4">
            <MudButton Variant="Variant.Filled"
                       Color="Color.Primary"
                       Disabled="@Loading"
                       OnClick="SaveClicked">
                @(IsEditing ? "ذخیره تغییرات" : "ثبت تسک")
            </MudButton>
            <MudButton Variant="Variant.Outlined"
                       Color="Color.Secondary"
                       Disabled="@Loading"
                       OnClick="CancelClicked">
                انصراف
            </MudButton>
        </MudStack>

        @if (errors.Length > 0)
        {
            <MudText Typo="Typo.subtitle2" Class="mt-3">خطاها:</MudText>
            @foreach (var err in errors)
            {
                <MudText Color="Color.Error">@err</MudText>
            }
        }
    </MudForm>
</MudPaper>
