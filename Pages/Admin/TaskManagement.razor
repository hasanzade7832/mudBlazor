@page "/admin/taskmanagement"
@using BlazorApp1.Models.TaskManagement
@using BlazorApp1.Models.Auth
@using BlazorApp1.Components.Modal
@inherits BlazorApp1.Pages.Admin.TaskManagementBase

<MudContainer MaxWidth="MaxWidth.Large" Class="mx-auto px-4 py-6">
    <MudStack Spacing="3">

        <!-- سرصفحه -->
        <MudStack Direction="Row" JustifyContent="Space-between" AlignItems="AlignItems.Center">
            <MudText Typo="Typo.h5" Class="text-indigo-700 font-extrabold">
                مدیریت تسک‌ها
            </MudText>

            <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="OpenAddModal">
                افزودن تسک
            </MudButton>
        </MudStack>

        <!-- جدول -->
        <TaskList Tasks="Tasks"
                  Users="Users"
                  OnEdit="EventCallback.Factory.Create<(TaskDto,string)>(this, OpenEditModal)"
                  OnDelete="EventCallback.Factory.Create<int>           (this, DeleteTaskAsync)"
                  OnConfirm="EventCallback.Factory.Create<int>           (this, ConfirmTaskAsync)" />

        <!-- مودال -->
        <Modal Open="ShowModal" OnClose="CloseModal">
            <AddTask Mode="@ModalMode"
                     InitialData="SelectedTask"
                     Users="Users"
                     Loading="ModalLoading"
                     OnCancel="CloseModal"
                     OnSubmit="HandleSubmitAsync"
                     OnSaved="HandleSubmitAsync" />
        </Modal>

    </MudStack>
</MudContainer>
